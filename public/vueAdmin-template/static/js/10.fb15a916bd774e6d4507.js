webpackJsonp([10],{ElU0:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=i("W+FH"),a=i("zL8q"),n={data:function(){return{listQuery:{name:"",del:"",page:1,limit:20},form:{id:"",pri_name:"",module_name:"",controller_name:"",action_name:"",img:"",parent_id:""},add:{parent:[]},parent:[],list:null,listLoading:!0,Controller:"",textMap:{update:"修改",create:"添加"},dialogVisible:!1,dialogdel:!1,dialogTitle:"",delId:0,options:[{value:0,label:"未禁用"},{value:1,label:"禁用"},{value:2,label:"全部"}],del:{type:null,title:"",content:"",url:""},pageSizes:[10,20,50,100],page:{currentPage:1,pageSize:10,total:1}}},created:function(){this.dialogVisible=!1,this.fetchData(),this.page.pageSize=10},methods:{fetchData:function(){var e=this;this.listLoading=!0,this.listQuery.page=this.page.currentPage,this.listQuery.limit=this.page.pageSize,Object(l.e)(this.listQuery,"/privilege/list").then(function(t){e.list=t.list,e.Controller=t.controller.toLowerCase(),console.log(e.Controller),e.page.total=t.count,e.listLoading=!1})},break:function(){var e=this;this.id="",this.form.pri_name="",this.form.module_name="",this.form.controller_name="",this.form.action_name="",this.form.img="",this.form.parent_id="",this.add.parent=[],Object(l.a)("{}","/"+this.Controller+"/getparent").then(function(t){e.add.parent.push(),t.parent.forEach(function(t){e.add.parent.push({id:t.id,pri_name:t.pri_name}),t.children&&t.children.forEach(function(t){e.add.parent.push({id:t.id,pri_name:"--"+t.pri_name}),t.children&&t.children.forEach(function(t){e.add.parent.push({id:t.id,pri_name:"----"+t.pri_name})})})})})},handleCreate:function(){this.break(),this.dialogVisible=!0,this.dialogTitle=this.textMap.create},handleUpdate:function(e){this.break(),console.log(e.parent_id),this.form.id=e.id,this.form.pri_name=e.pri_name,this.form.module_name=e.module_name,this.form.controller_name=e.controller_name,this.form.action_name=e.action_name,this.form.img=e.img,this.form.parent_id=e.parent_id,this.dialogVisible=!0,this.dialogTitle=this.textMap.update},create:function(){var e=this;this.listLoading=!0,Object(l.b)(this.form,"/"+this.Controller+"/add").then(function(t){e.dialogVisible=!1,e.fetchData()},function(e){console.log(e),Object(a.Message)({message:e.content,type:"error",duration:5e3})}),this.listLoading=!1},update:function(){var e=this;this.listLoading=!0,this.form.id===this.form.parent_id?Object(a.Message)({message:"自身不能为父级",type:"error",duration:5e3}):Object(l.d)(this.form,"/"+this.Controller+"/edit").then(function(t){e.dialogVisible=!1,e.fetchData()},function(e){Object(a.Message)({message:e.content,type:"error",duration:5e3})}),this.listLoading=!1},softDel:function(e){this.dialogdel=!0,this.delId=e.id,this.del.title="禁用",this.del.content="确认禁用吗？",this.del.url="/"+this.Controller+"/softDel"},postDel:function(){var e=this;0===this.i&&Object(a.Message)({message:"错误",type:"error",duration:5e3}),Object(l.c)({id:this.delId},this.del.url).then(function(t){e.dialogdel=!1,e.fetchData()}),this.delId=0},remove:function(e){this.dialogdel=!0,this.delId=e.id,this.del.title="删除",this.del.content="确认删除吗？",this.del.url="/"+this.Controller+"/remove"},recover:function(e){this.dialogdel=!0,this.delId=e.id,this.del.title="恢复",this.del.content="确认恢复吗？",this.del.url="/"+this.Controller+"/recover"},handleSizeChange:function(e){this.page.pageSize=e,this.fetchData()},handleCurrentChange:function(e){this.page.currentPage=e,this.fetchData()},handleClose:function(e){}}},o={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("div",{staticClass:"filter-container",staticStyle:{"margin-bottom":"20px"}},[i("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"用户名"},model:{value:e.listQuery.name,callback:function(t){e.$set(e.listQuery,"name",t)},expression:"listQuery.name"}}),e._v(" "),i("el-select",{attrs:{placeholder:"请选择"},model:{value:e.listQuery.del,callback:function(t){e.$set(e.listQuery,"del",t)},expression:"listQuery.del"}},e._l(e.options,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),i("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.fetchData}},[e._v("搜索")]),e._v(" "),i("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-edit"},on:{click:e.handleCreate}},[e._v("添加")]),e._v(" "),i("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-download"}},[e._v("下载")]),e._v(" "),i("el-dialog",{attrs:{title:e.dialogTitle,"label-width":"80px",visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("el-form",{attrs:{model:e.form,"label-width":"85px"}},[i("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{label:"id"}},[i("el-input",{model:{value:e.form.id,callback:function(t){e.$set(e.form,"id",t)},expression:"form.id"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"上级权限"}},[i("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.form.parent_id,callback:function(t){e.$set(e.form,"parent_id",t)},expression:"form.parent_id"}},[i("el-option",{key:"0",attrs:{label:"最高权限",value:"0"}}),e._v(" "),e._l(e.add.parent,function(e){return i("el-option",{key:e.id,attrs:{label:e.pri_name,value:e.id}})})],2)],1),e._v(" "),i("el-form-item",{attrs:{label:"图标"}},[i("el-input",{model:{value:e.form.img,callback:function(t){e.$set(e.form,"img",t)},expression:"form.img"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"权限名称"}},[i("el-input",{model:{value:e.form.pri_name,callback:function(t){e.$set(e.form,"pri_name",t)},expression:"form.pri_name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"模块名称"}},[i("el-input",{model:{value:e.form.module_name,callback:function(t){e.$set(e.form,"module_name",t)},expression:"form.module_name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"控制器名称"}},[i("el-input",{model:{value:e.form.controller_name,callback:function(t){e.$set(e.form,"controller_name",t)},expression:"form.controller_name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"方法名称"}},[i("el-input",{model:{value:e.form.action_name,callback:function(t){e.$set(e.form,"action_name",t)},expression:"form.action_name"}})],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),"添加"==e.dialogTitle?i("el-button",{attrs:{type:"primary"},on:{click:e.create}},[e._v(e._s(e.dialogTitle))]):i("el-button",{attrs:{type:"primary"},on:{click:e.update}},[e._v(e._s(e.dialogTitle))])],1)],1)],1),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:e.listLoading,expression:"listLoading",modifiers:{body:!0}}],attrs:{data:e.list,"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":""}},[i("el-table-column",{attrs:{align:"center",label:"ID",width:"95"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.$index)+"\n      ")]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"权限名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.pri_name)+"\n      ")]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"模块",width:"110",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.module_name))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"控制器",width:"110",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.controller_name))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"方法",width:"110",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.action_name))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"创建时间",width:"110",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.created_at)+"\n      ")]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"跟新时间",width:"110",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.updated_at)+"\n      ")]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"操作",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.deleted_at?e._e():i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(i){e.handleUpdate(t.row)}}},[e._v("修改")]),e._v(" "),t.row.deleted_at?e._e():i("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(i){e.softDel(t.row)}}},[e._v("禁用")]),e._v(" "),t.row.deleted_at?i("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(i){e.recover(t.row)}}},[e._v("恢复")]):e._e(),e._v(" "),t.row.deleted_at?i("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(i){e.remove(t.row)}}},[e._v("删除")]):e._e()]}}])})],1),e._v(" "),i("div",{staticClass:"block",staticStyle:{"padding-left":"25px","padding-top":"15px"}},[i("el-pagination",{attrs:{"prev-text":"上一页","next-text":"下一页","popper-class":"页","current-page":e.page.currentPage,"page-sizes":e.pageSizes,"page-size":e.page.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.page.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),i("el-dialog",{attrs:{title:e.del.title,visible:e.dialogdel,width:"30%"},on:{"update:visible":function(t){e.dialogdel=t}}},[i("span",[e._v(e._s(e.del.content))]),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogdel=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.postDel}},[e._v("确 定")])],1)])],1)},staticRenderFns:[]},r=i("VU/8")(n,o,!1,null,null,null);t.default=r.exports}});